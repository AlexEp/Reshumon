<div *ngIf="isDataReady; else elseBlock">
  <!-- Tools panel -->
  <div class="row">
    <div class="card toolbar-card">
      <div class="card-body row float-none">

        <div class="col-4 col-sm-4 col-md-2 ">
          <button id="list " [ngClass]="{ 'btn-warning' : isDataChanged , 'btn-secondary' : !isDataChanged }" class="btn btn-warning "
            [disabled]="!isDataChanged" (click)="onRevert() ">
            <i class="fa fa-undo" aria-hidden="true "></i><span class="d-none d-sm-inline">{{ translateWorld('revert')
              | translate}}</span></button>
        </div>
        <div class="col-4 col-sm-4 col-md-2">
          <button id="list " class="btn " [ngClass]="{ 'btn-success' : isDataChanged , 'btn-secondary' : !isDataChanged }"
            [disabled]="!isDataChanged" (click)="onSave() ">
            <i class="fa fa-floppy-o " aria-hidden="true "></i><span class="d-none d-sm-inline">{{
              translateWorld('save') | translate}}</span></button>
        </div>
        <div class="col-4 col-sm-4 col-md-2">
          <button id="list " class="btn btn-primary" (click)="onCreateClicked()">
            <i class="fa fa-plus-circle" aria-hidden="true "></i><span class="d-none d-sm-inline">{{
              translateWorld('new') | translate}}</span></button>
        </div>
        <div class="col-12 col-sm-12 col-md-6">

          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="inputGroupPrepend2"> <i class="fa fa-search" aria-hidden="true"></i></span>
            </div>
            <input type="text" class="form-control" id="search" placeholder="Search users name" [(ngModel)]="search"
              autocomplete="off">
          </div>
        </div>

      </div>
    </div>
  </div>
  <!-- Data Table -->
  <div class="row">
    <div class="card">
      <div class="card-header">
        <h3> {{translateWorld('users managment') | translate}}</h3>

      </div>


      <div class="card-body mw-100">
        <p-table [value]="users" [responsive]="true">
          <ng-template pTemplate="header">
            <tr>
              <th class="ui-p-2" style="width: 15%">{{translateWorld('edit') | translate}}
              </th>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" class="th-{{col.field}}">
                {{col.header}}
                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order"
                  ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-users>
            <tr>
              <td class="ui-p-2">
                <i id="btn-row-delete" class="btn btn-outline-danger fa fa-trash btn-hover" aria-hidden="true" (click)="onDeleteClicked(users)"></i>
              </td>

              <!-- UserName -->
              <td class="ui-p-3">
                {{users.UserName}}
              </td>


              <!-- FirstName -->
              <td class="ui-p-3">
                <input class="form-control is-invalid" #inputFirstName="ngModel" autocomplete="off" (change)="onChange(users)"
                  [ngClass]="{'is-invalid': !(inputFirstName.valid), 'is-valid': inputFirstName.valid }" id="FirstName"
                  name="FirstName" [(ngModel)]="users.FirstName" required />

                <small id="passwordHelpBlock" class="invalid-feedback" [ngClass]="{'d-invalid':!inputFirstName.valid}">
                  This filed is requred
                </small>
              </td>

              <!-- LastName -->
              <td class="ui-p-3">
                <input class="form-control is-invalid" #inputLastName="ngModel" autocomplete="off" (change)="onChange(users)"
                  [ngClass]="{'is-invalid': !(inputLastName.valid), 'is-valid': inputLastName.valid }" id="LastName"
                  name="LastName" [(ngModel)]="users.LastName" required />

                <small id="passwordHelpBlock" class="invalid-feedback" [ngClass]="{'d-invalid':!inputLastName.valid}">
                  This filed is requred
                </small>
              </td>

              <!-- Email -->
              <td class="ui-p-3">
                <input class="form-control is-invalid" #inputEmail="ngModel" autocomplete="off" (change)="onChange(users)"
                  [ngClass]="{'is-invalid': !(inputEmail.valid), 'is-valid': inputEmail.valid }" id="Email"
                  name="Email" [(ngModel)]="users.Email" required />

                <small id="passwordHelpBlock" class="invalid-feedback" [ngClass]="{'d-invalid':!inputEmail.valid}">
                  This filed is requred
                </small>
              </td>


                    <!-- JoinDate -->
                    <td class="ui-p-3">
                       {{users.JoinDate | date:'yyyy-MM-dd'}}
                      </td>

              <!-- IsUseDiningRoom -->
              <td class="ui-p-3">
                  <input type="checkbox" name="IsUseDiningRoom" class="form-control" id="IsUseDiningRoom" [(ngModel)]="users.IsUseDiningRoom"
                    (change)="onChange(users)" />
                </td>

                
              <td class="ui-p-3">
                <input type="checkbox" name="isActive" class="form-control" id="isActive" [(ngModel)]="users.IsActive"
                  (change)="onChange(users)" />
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>




</div>

<!-- ------------- [Loading Animation] -------------- -->
<ng-template #elseBlock>
  <app-animated-loading *ngIf="!isDataLodingFailed"></app-animated-loading>
  <div *ngIf="isDataLodingFailed" class="">
    <div class="alert alert-danger" role="alert">
      <strong>{{'Loading Data Failed'}}</strong>
    </div>
  </div>
</ng-template>

<!-- ------------- [Dialog - Edit] -------------- -->
<p-dialog header="User Details" [(visible)]="displayEditDialog" [responsive]="true" showEffect="fade" [modal]="true" [width]="300">
    <div class="ui-g ui-fluid" *ngIf="userToCreate">
        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="vin">First Name</label>
            </div>
            <div class="ui-g-8">
                <input pInputText id="FirstName" [(ngModel)]="userToCreate.FirstName" required minlength="2" maxlength="50" />
            </div>
        </div>
        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="year">Last Name</label>
            </div>
            <div class="ui-g-8">
                <input pInputText id="LastName" [(ngModel)]="userToCreate.LastName" required minlength="2" maxlength="50"/>
            </div>
        </div>
        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="year">Email</label>
            </div>
            <div class="ui-g-8">
                <input type="email" pInputText  id="Email" [(ngModel)]="userToCreate.Email" required />
            </div>
        </div>
        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="year">Password</label>
            </div>
            <div class="ui-g-8">
                <input type="password" pInputText id="Password" [(ngModel)]="userToCreate.Password" required minlength="6" />
            </div>
        </div>

        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="year">Password Confirm</label>
            </div>
            <div class="ui-g-8">
                <input type="password" pInputText id="PasswordConfirm" [(ngModel)]="userToCreate.Confirm" required minlength="6" />
            </div>
        </div>

        <div class="ui-g-12">
            <div class="ui-g-4">
                <label for="year">Dining Room</label>
            </div>
            <div class="ui-g-8">
                <input type="checkbox" pInputText id="diningRoom" [(ngModel)]="userToCreate.IsUseDiningRoom" />
            </div>
        </div>
 
    </div>
    <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
            <button type="button" pButton icon="fa fa-close" (click)="dialogCancel()" label="Cancel"></button>
            <button type="button" pButton icon="fa fa-check" (click)="dialogOk()" [label]="isNewUser()? 'Create' : 'Save'"></button>
        </div>
    </p-footer>
</p-dialog>
<!-- ------------- [Dialog - Confirm Delete] -------------- -->

<p-dialog header="Confirm Delete" [(visible)]="displayConfirmDeleteDialog" [responsive]="true" showEffect="fade"
  [modal]="true" [width]="300">
  <div class="ui-dialog-buttonpane ui-helper-clearfix">
    <button type="button" pButton icon="fa fa-close" (click)="cancelDelete()" label="Cancel"></button>
    <button type="button" pButton icon="fa fa-check" (click)="delete()" label="Delete"></button>
  </div>
</p-dialog>